# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

                        ##### Variables #####

# assign modkeys to variables just for simplicity
set $ctrl Control
set $shift Shift
set $super Mod4
set $alt Mod1
set $mod Mod4

# modkey aliases for navigation
# Mod4 focus
# Ctrl navigate (workspaces)
# Shift navgiate at the level of workspaces/outputs
# Alt reposition

# focus = change window/container focus within workspace
set $focus Mod4
# focus+movespace = focus output
set $focusoutput Mod4+Shift
# focus+move = reposition window/container in workspace
set $move Mod4+Mod1
# focus+navigate = go to workspace
set $goto Mod4+Control
# focus+navigate+movewin = move window to workspace
set $moveto Mod4+Control+Mod1
# focus+navigate+movespace = move workspace (to output)
set $movespace Mod4+Control+Shift

# vim hjkl direction bindings, because switching between vim-style and
# i3-style is very confusing
set $left h
set $right l
set $up k
set $down j

# numpad keycodes - Mod2 required here per https://github.com/i3/i3/issues/2558
set $kp_0 Mod2+KP_0
set $kp_1 Mod2+KP_1
set $kp_2 Mod2+KP_2
set $kp_3 Mod2+KP_3
set $kp_4 Mod2+KP_4
set $kp_5 Mod2+KP_5
set $kp_6 Mod2+KP_6
set $kp_7 Mod2+KP_7
set $kp_8 Mod2+KP_8
set $kp_9 Mod2+KP_9

# modes
set $mode_system (l)ock, (e)xit, (s)uspend, (h)ibernate, (r)eboot, (Shift+s)hutdown

set $resize_amount 20 px or 5 ppt
set $big_resize_amount 100 px or 10 ppt


                        ##### i3 Config #####

font pango:Droid Sans 10

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
    status_command i3status
    tray_output primary
    position top
    font xft:DroidSans 12
}


focus_follows_mouse no


                       ##### Startup Stuff ####

# workspaces
workspace 0 output eDP-1
workspace 1 output DP-2

# network manager taskbar applet
exec_always --no-startup-id nm-applet

# bluetooth manager taskbar applet
exec_always --no-startup-id blueman-applet

# keyboard stuff
exec_always --no-startup-id numlockx on
exec_always --no-startup-id setxkbmap -layout us -option caps:escape

# use GNOME keyring for caching SSH keys, passwords, etc.
exec_always --no-startup-id ~/.config/i3/scripts/gnome-keyring.sh
exec_always --no-startup-id ~/.xprofile

# can't remember why this is here but I don't want to deal with what
# happens if I take it out
exec_always --no-startup-id gnome-settings-daemon

# Japanese support
exec --no-startup-id fcitx -d

# Synology
exec --no-startup-id synology-drive

# Scratchpad
exec --no-startup-id keepassxc
exec --no-startup-id pavucontrol
exec --no-startup-id blueman-manager
exec --no-startup-id gnome-calculator

# Window assignments
for_window [title="Tabs Outliner"] move to scratchpad, resize set 600 1200
for_window [class="keepassxc"] move to scratchpad, resize set 800 600
for_window [class="Pavucontrol"] move to scratchpad, resize set 800 600
for_window [class="Blueman-manager"] move to scratchpad, resize set 800 600
for_window [class="gnome-calculator"] move to scratchpad, resize set 400 300

for_window [title="Authy"] floating enable
for_window [title="Pomodoro Timer"] floating enable

                      ##### Basic Bindings #####

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

                         ### Nonstandard ###

bindsym Print exec --no-startup-id gnome-screenshot

# Volume control TODO: these don't work
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5%
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5%
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle

# Media keys
bindsym XF86AudioPlay exec --no-startup-id playerctl play-pause -p spotify
bindsym XF86AudioPause exec --no-startup-id playerctl pause-pause -p spotify
bindsym XF86AudioNext exec --no-startup-id playerctl next -p spotify
bindsym XF86AudioPrev exec --no-startup-id playerctl previous -p spotify

                         ### Mod Commands ###

## Mod+number ##

bindsym $mod1 workspace number 1
bindsym $mod2 workspace number 2
bindsym $mod3 workspace number 3
bindsym $mod4 workspace number 4
bindsym $mod5 workspace number 5
bindsym $mod6 workspace number 6
bindsym $mod7 workspace number 7
bindsym $mod8 workspace number 8
bindsym $mod9 workspace number 9
bindsym $mod0 workspace number 10
bindsym $mod+$kp_1 workspace number 1
bindsym $mod+$kp_2 workspace number 2
bindsym $mod+$kp_3 workspace number 3
bindsym $mod+$kp_4 workspace number 4
bindsym $mod+$kp_5 workspace number 5
bindsym $mod+$kp_6 workspace number 6
bindsym $mod+$kp_7 workspace number 7
bindsym $mod+$kp_8 workspace number 8
bindsym $mod+$kp_9 workspace number 9
bindsym $mod+$kp_0 workspace number 10

## Mod+letter ##

bindsym $mod+a focus parent
bindsym $mod+d exec dmenu_run
bindsym $mod+f focus mode_toggle
bindsym $mod+g exec i3-input -F 'workspace "%s"' -P 'Go to workspace: '
bindsym $mod+m mode "move"
bindsym $mod+n exec i3-input -F 'move container to workspace "%s"' -P 'Move to workspace: '
bindsym $mod+r mode "resize"
bindsym $mod+s focus child
bindsym $mod+v split vertical

## Mod+symbol ##

bindsym $mod+grave scratchpad show

## Mod+special ##

bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

bindsym $mod+Return exec i3-sensible-terminal
bindsym $mod+space exec --no-startup-id i3-dmenu-desktop
bindsym $mod+Tab layout toggle tabbed splitv splith
bindsym $mod+F11 fullscreen toggle

                      ### Mod+Shift Commands ###
                  ### (reposition in workspace) ###

# Navigation and i3 control.

bindsym $mod+Shift+asciitilde move scratchpad
bindsym $mod+Shift+1 [title="Tabs Outliner"] scratchpad show
bindsym $mod+Shift+2 [class="keepassxc"] scratchpad show
bindsym $mod+Shift+3 [class="Pavucontrol"] scratchpad show
bindsym $mod+Shift+4 [class="Blueman-manager"] scratchpad show
bindsym $mod+Shift+5 [title="Calculator"] scratchpad show

bindsym $mod+Shift+c reload
bindsym $mod+Shift+e mode "$mode_system"
bindsym $mod+Shift+f floating toggle
bindsym $mod+Shift+g exec i3-input -F 'rename workspace to "%s"' -P 'New name: '
bindsym $mod+Shift+q kill
bindsym $mod+Shift+r restart
bindsym $mod+Shift+s exec --no-startup-id gnome-screenshot -a

bindsym $focusoutput+Left focus output left
bindsym $focusoutput+Right focus output right
bindsym $focusoutput+$left focus output left
bindsym $focusoutput+$right focus output right

bindsym $mod+Shift+Print exec --no-startup-id gnome-screenshot -i

                       ### Mod+Alt Commands ###
# Reposition within the current workspace.

bindsym $move+$left move left
bindsym $move+$down move down
bindsym $move+$up move up
bindsym $move+$right move right
bindsym $move+Left move left
bindsym $move+Down move down
bindsym $move+Up move up
bindsym $move+Right move right

                      ### Mod+Ctrl Commands ###

# Navigate between workspaces.

bindsym $goto+1 workspace number 1
bindsym $goto+2 workspace number 2
bindsym $goto+3 workspace number 3
bindsym $goto+4 workspace number 4
bindsym $goto+5 workspace number 5
bindsym $goto+6 workspace number 6
bindsym $goto+7 workspace number 7
bindsym $goto+8 workspace number 8
bindsym $goto+9 workspace number 9
bindsym $goto+0 workspace number 10

bindsym $goto+$kp_1 workspace number 1
bindsym $goto+$kp_2 workspace number 2
bindsym $goto+$kp_3 workspace number 3
bindsym $goto+$kp_4 workspace number 4
bindsym $goto+$kp_5 workspace number 5
bindsym $goto+$kp_6 workspace number 6
bindsym $goto+$kp_7 workspace number 7
bindsym $goto+$kp_8 workspace number 8
bindsym $goto+$kp_9 workspace number 9
bindsym $goto+$kp_0 workspace number 10

bindsym $goto+$left  workspace prev
bindsym $goto+$right workspace next
bindsym $goto+Left   workspace prev
bindsym $goto+Right  workspace next


                   ### Mod+Ctrl+Shift Commands ###
                  ### (move window to workspace) ###

bindsym $moveto+1 move container to workspace number 1; workspace number 1
bindsym $moveto+2 move container to workspace number 2; workspace number 2
bindsym $moveto+3 move container to workspace number 3; workspace number 3
bindsym $moveto+4 move container to workspace number 4; workspace number 4
bindsym $moveto+5 move container to workspace number 5; workspace number 5
bindsym $moveto+6 move container to workspace number 6; workspace number 6
bindsym $moveto+7 move container to workspace number 7; workspace number 7
bindsym $moveto+8 move container to workspace number 8; workspace number 8
bindsym $moveto+9 move container to workspace number 9; workspace number 9
bindsym $moveto+0 move container to workspace number 10; workspace number 10

bindsym $moveto+$kp_1 move container to workspace number 1; workspace number 1
bindsym $moveto+$kp_2 move container to workspace number 2; workspace number 2
bindsym $moveto+$kp_3 move container to workspace number 3; workspace number 3
bindsym $moveto+$kp_4 move container to workspace number 4; workspace number 4
bindsym $moveto+$kp_5 move container to workspace number 5; workspace number 5
bindsym $moveto+$kp_6 move container to workspace number 6; workspace number 6
bindsym $moveto+$kp_7 move container to workspace number 7; workspace number 7
bindsym $moveto+$kp_8 move container to workspace number 8; workspace number 8
bindsym $moveto+$kp_9 move container to workspace number 9; workspace number 9
bindsym $moveto+$kp_0 move container to workspace number 10; workspace number 10

# move container to next/previous workspace
bindsym $moveto+$left move container to workspace prev; workspace prev
bindsym $moveto+$right move container to workspace next; workspace next
bindsym $moveto+Left move container to workspace prev; workspace prev
bindsym $moveto+Right move container to workspace next; workspace next

                 ### Mod+Ctrl+Shift+Alt Commands ###
                 ###  (move workspace to output) ###

bindsym $movespace+$left move workspace to output left
bindsym $movespace+$right move workspace to output right
bindsym $movespace+Left move workspace to output left
bindsym $movespace+Right move workspace to output right


                          ##### Modes #####

# move focused window within workspace
mode "move" {
    # alternatively, you can use the cursor keys:
    bindsym $left move left
    bindsym $down move down
    bindsym $up move up
    bindsym $right move right

    # alternatively, you can use the cursor keys:
    bindsym Left move left
    bindsym Down move down
    bindsym Up move up
    bindsym Right move right

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+m mode "default"
    bindsym m mode "default"
}

mode "resize" {
    bindsym $left resize shrink width $resize_amount
    bindsym $down resize grow height $resize_amount
    bindsym $up resize shrink height $resize_amount
    bindsym $right resize grow width $resize_amount
    bindsym Left resize shrink width $resize_amount
    bindsym Down resize grow height $resize_amount
    bindsym Up resize shrink height $resize_amount
    bindsym Right resize grow width $resize_amount

    bindsym $shift+$left resize shrink width $big_resize_amount
    bindsym $shift+$down resize grow height $big_resize_amount
    bindsym $shift+$up resize shrink height $big_resize_amount
    bindsym $shift+$right resize grow width $big_resize_amount
    bindsym $shift+Left resize shrink width $big_resize_amount
    bindsym $shift+Down resize grow height $big_resize_amount
    bindsym $shift+Up resize shrink height $big_resize_amount
    bindsym $shift+Right resize grow width $big_resize_amount

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"
}

mode "$mode_system" {
    bindsym l exec --no-startup-id gnome-screensaver-command -l, mode "default"
    bindsym s exec --no-startup-id systemctl suspend, mode "default"
    bindsym e exec --no-startup-id i3-msg exit, mode "default"
    bindsym h exec --no-startup-id systemctl hibernate, mode "default"
    bindsym r exec --no-startup-id systemctl reboot, mode "default"
    bindsym Shift+s exec --no-startup-id systemctl shutdown, mode "default"

    # exit system mode: "Enter" or "Escape"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
