# i3 config file (v4)
#
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

                        ##### Variables #####

# assign modkeys to variables just for simplicity
set $ctrl Control
set $shift Shift
set $super Mod4
set $alt Mod1
set $mod Mod4

# vim hjkl direction bindings, because switching between vim-style and
# i3-style is very confusing
set $left h
set $right l
set $up k
set $down j

# numpad keycodes - Mod2 required here per https://github.com/i3/i3/issues/2558
set $kp_0 Mod2+KP_0
set $kp_1 Mod2+KP_1
set $kp_2 Mod2+KP_2
set $kp_3 Mod2+KP_3
set $kp_4 Mod2+KP_4
set $kp_5 Mod2+KP_5
set $kp_6 Mod2+KP_6
set $kp_7 Mod2+KP_7
set $kp_8 Mod2+KP_8
set $kp_9 Mod2+KP_9

# modes
set $mode_system (l)ock, (e)xit, (s)uspend, (h)ibernate, (r)eboot, (Shift+s)hutdown

set $resize_amount 20 px or 10 ppt
set $big_resize_amount 100 px or 20 ppt


                        ##### i3 Config #####

font pango:Droid Sans 10

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
    status_command i3status
    tray_output primary
    position top
    font xft:DroidSans 12
}


focus_follows_mouse no


                       ##### Startup Stuff ####
# network manager taskbar applet
exec_always --no-startup-id nm-applet

# bluetooth manager taskbar applet
exec_always --no-startup-id blueman-applet

# keyboard stuff
exec_always --no-startup-id numlockx on
exec_always --no-startup-id setxkbmap -layout us -option caps:escape

# use GNOME keyring for caching SSH keys, passwords, etc.
exec_always ~/.config/i3/scripts/gnome-keyring.sh

# can't remember why this is here but I don't want to deal with what
# happens if I take it out
exec_always --no-startup-id gnome-settings-daemon

# Japanese support
exec --no-startup-id fcitx -d

# Synology
exec --no-startup-id synology-cloud-station-backup
exec --no-startup-id synology-drive

# Window assignments
for_window [title="Tabs Outliner"] move to scratchpad, resize set 600 1200, scratchpad show
for_window [class="keepassxc"] move to scratchpad, resize set 800 600, scratchpad show
for_window [class="Pavucontrol"] move to scratchpad, resize set 800 600, scratchpad show
for_window [class="Blueman-manager"] move to scratchpad, resize set 800 600, scratchpad show
for_window [title="Authy"] floating enable

                      ##### Basic Bindings #####

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

                         ### Nonstandard ###

bindsym Print exec --no-startup-id gnome-screenshot

# Volume control TODO: these don't work
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5%
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5%
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle

# Media keys
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioPause exec playerctl pause-pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous

                         ### Mod Commands ###

## Mod+number ##

bindsym $mod+asciitilde move scratchpad
bindsym $mod+1 [title="Tabs Outliner"] scratchpad show
bindsym $mod+2 [class="keepassxc"] scratchpad show
bindsym $mod+3 [class="Pavucontrol"] scratchpad show
bindsym $mod+4 [class="Blueman-manager"] scratchpad show

## Mod+letter ##

bindsym $mod+a focus parent
bindsym $mod+d exec dmenu_run
bindsym $mod+f focus mode_toggle
bindsym $mod+g exec i3-input -F 'workspace "%s"' -P 'Go to workspace: '
bindsym $mod+m mode "move"
bindsym $mod+n exec i3-input -F 'move container to workspace "%s"' -P 'Move to workspace: '
bindsym $mod+r mode "resize"
bindsym $mod+s focus child
bindsym $mod+v split vertical

## Mod+symbol ##

bindsym $mod+grave scratchpad show

## Mod+special ##

bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

bindsym $mod+Return exec i3-sensible-terminal
bindsym $mod+space exec --no-startup-id i3-dmenu-desktop
bindsym $mod+Tab layout toggle tabbed splitv splith
bindsym $mod+F11 fullscreen toggle

                      ### Mod+Shift Commands ###

# Navigation and i3 control.

bindsym $mod+Shift+1 workspace number 1
bindsym $mod+Shift+2 workspace number 2
bindsym $mod+Shift+3 workspace number 3
bindsym $mod+Shift+4 workspace number 4
bindsym $mod+Shift+5 workspace number 5
bindsym $mod+Shift+6 workspace number 6
bindsym $mod+Shift+7 workspace number 7
bindsym $mod+Shift+8 workspace number 8
bindsym $mod+Shift+9 workspace number 9
bindsym $mod+Shift+0 workspace number 10
bindsym $mod+$kp_1 workspace number 1
bindsym $mod+$kp_2 workspace number 2
bindsym $mod+$kp_3 workspace number 3
bindsym $mod+$kp_4 workspace number 4
bindsym $mod+$kp_5 workspace number 5
bindsym $mod+$kp_6 workspace number 6
bindsym $mod+$kp_7 workspace number 7
bindsym $mod+$kp_8 workspace number 8
bindsym $mod+$kp_9 workspace number 9
bindsym $mod+$kp_0 workspace number 10

bindsym $mod+Shift+c reload
bindsym $mod+Shift+e mode "$mode_system"
bindsym $mod+Shift+f floating toggle
bindsym $mod+Shift+g exec i3-input -F 'rename workspace to "%s"' -P 'New name: '
bindsym $mod+Shift+q kill
bindsym $mod+Shift+r restart
bindsym $mod+Shift+s exec --no-startup-id gnome-screenshot -a

bindsym $mod+Shift+$left workspace prev
bindsym $mod+Shift+$right workspace next
bindsym $mod+Shift+Left workspace prev
bindsym $mod+Shift+Right workspace next

bindsym $mod+Shift+Print exec --no-startup-id gnome-screenshot -i

                       ### Mod+Alt Commands ###

# Reposition within the current workspace.

bindsym $mod+$alt+$left move left
bindsym $mod+$alt+$down move down
bindsym $mod+$alt+$up move up
bindsym $mod+$alt+$right move right
bindsym $mod+$alt+Left move left
bindsym $mod+$alt+Down move down
bindsym $mod+$alt+Up move up
bindsym $mod+$alt+Right move right

                      ### Mod+Ctrl Commands ###

# Move containers between workspaces.

# move container and jump with it - TODO: switch these to $mod+$ctrl instead
bindsym $mod+$ctrl+1 move container to workspace number 1; workspace number 1
bindsym $mod+$ctrl+2 move container to workspace number 2; workspace number 2
bindsym $mod+$ctrl+3 move container to workspace number 3; workspace number 3
bindsym $mod+$ctrl+4 move container to workspace number 4; workspace number 4
bindsym $mod+$ctrl+5 move container to workspace number 5; workspace number 5
bindsym $mod+$ctrl+6 move container to workspace number 6; workspace number 6
bindsym $mod+$ctrl+7 move container to workspace number 7; workspace number 7
bindsym $mod+$ctrl+8 move container to workspace number 8; workspace number 8
bindsym $mod+$ctrl+9 move container to workspace number 9; workspace number 9
bindsym $mod+$ctrl+0 move container to workspace number 10; workspace number 10

bindsym $mod+$ctrl+$kp_1 move container to workspace number 1; workspace number 1
bindsym $mod+$ctrl+$kp_2 move container to workspace number 2; workspace number 2
bindsym $mod+$ctrl+$kp_3 move container to workspace number 3; workspace number 3
bindsym $mod+$ctrl+$kp_4 move container to workspace number 4; workspace number 4
bindsym $mod+$ctrl+$kp_5 move container to workspace number 5; workspace number 5
bindsym $mod+$ctrl+$kp_6 move container to workspace number 6; workspace number 6
bindsym $mod+$ctrl+$kp_7 move container to workspace number 7; workspace number 7
bindsym $mod+$ctrl+$kp_8 move container to workspace number 8; workspace number 8
bindsym $mod+$ctrl+$kp_9 move container to workspace number 9; workspace number 9
bindsym $mod+$ctrl+$kp_0 move container to workspace number 10; workspace number 10

# move container to next/previous workspace
bindsym $mod+$ctrl+$left move container to workspace prev; workspace prev
bindsym $mod+$ctrl+$right move container to workspace next; workspace next
bindsym $mod+$ctrl+Left move container to workspace prev; workspace prev
bindsym $mod+$ctrl+Right move container to workspace next; workspace next


                          ##### Modes #####

# move focused window within workspace
mode "move" {
    # alternatively, you can use the cursor keys:
    bindsym $left move left
    bindsym $down move down
    bindsym $up move up
    bindsym $right move right

    # alternatively, you can use the cursor keys:
    bindsym Left move left
    bindsym Down move down
    bindsym Up move up
    bindsym Right move right

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+m mode "default"
    bindsym m mode "default"
}

mode "resize" {
    bindsym $left resize shrink width $resize_amount
    bindsym $down resize grow height $resize_amount
    bindsym $up resize shrink height $resize_amount
    bindsym $right resize grow width $resize_amount
    bindsym Left resize shrink width $resize_amount
    bindsym Down resize grow height $resize_amount
    bindsym Up resize shrink height $resize_amount
    bindsym Right resize grow width $resize_amount

    bindsym $shift+$left resize shrink width $big_resize_amount
    bindsym $shift+$down resize grow height $big_resize_amount
    bindsym $shift+$up resize shrink height $big_resize_amount
    bindsym $shift+$right resize grow width $big_resize_amount
    bindsym $shift+Left resize shrink width $big_resize_amount
    bindsym $shift+Down resize grow height $big_resize_amount
    bindsym $shift+Up resize shrink height $big_resize_amount
    bindsym $shift+Right resize grow width $big_resize_amount

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"
}

mode "$mode_system" {
    bindsym l exec --no-startup-id gnome-screensaver-command -l, mode "default"
    bindsym s exec --no-startup-id systemctl suspend, mode "default"
    bindsym e exec --no-startup-id i3-msg exit, mode "default"
    bindsym h exec --no-startup-id systemctl hibernate, mode "default"
    bindsym r exec --no-startup-id systemctl reboot, mode "default"
    bindsym Shift+s exec --no-startup-id systemctl shutdown, mode "default"

    # exit system mode: "Enter" or "Escape"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
